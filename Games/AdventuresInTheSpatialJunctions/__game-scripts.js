var Objectcontroller=pc.createScript("objectcontroller"),moveMult=3,fwd=0,lr=0,rot=0;Objectcontroller.prototype.initialize=function(){},Objectcontroller.prototype.update=function(r){W=this.app.keyboard.isPressed(pc.KEY_W),A=this.app.keyboard.isPressed(pc.KEY_A),S=this.app.keyboard.isPressed(pc.KEY_S),D=this.app.keyboard.isPressed(pc.KEY_D),arrow_right=this.app.keyboard.isPressed(pc.KEY_RIGHT),arrow_left=this.app.keyboard.isPressed(pc.KEY_LEFT),W&&(fwd=.01),S&&(fwd=-.01),!S&!W&&(fwd=0),D&&(lr=.01),A&&(lr=-.01),!A&!D&&(lr=0),arrow_right&&(rot=-1),arrow_left&&(rot=1),!arrow_right&!arrow_left&&(rot=0),this.entity.translateLocal(fwd*moveMult,0,lr*moveMult),this.entity.rotateLocal(0,rot,0)};var Charactercontroller=pc.createScript("charactercontroller"),hasBlueKey=!1,hasYellowKey=!1,hasRedKey=!1,playerHealth=100,playerEnergy=100,deathSoundPlayed=!1,walking=!1;Charactercontroller.attributes.add("moveMult",{type:"number",default:1}),Charactercontroller.attributes.add("camera",{type:"entity",default:null}),Charactercontroller.attributes.add("actionText",{type:"entity"}),Charactercontroller.attributes.add("UIV2_Energy",{type:"entity"}),Charactercontroller.attributes.add("UIV2_Health",{type:"entity"}),Charactercontroller.attributes.add("EnergyText",{type:"entity"}),Charactercontroller.attributes.add("HealthText",{type:"entity"}),Charactercontroller.attributes.add("DamageOverlay",{type:"entity"}),Charactercontroller.attributes.add("DeathObjects",{type:"entity"}),Charactercontroller.attributes.add("EnergyBars",{type:"asset",assetType:"texture",array:!0}),Charactercontroller.attributes.add("HealthBars",{type:"asset",assetType:"texture",array:!0}),Charactercontroller.attributes.add("DEATHSCREEN",{type:"entity"});var fwd=0,lr=0,rot=0,force=new pc.Vec3;function reduceSpeed(e){!W&!S&!A&!D&&(slowforce=new pc.Vec3,slowforce.set(-e.rigidbody.linearVelocity.x,0,-e.rigidbody.linearVelocity.z).normalize().scale(5),e.rigidbody.applyForce(slowforce),e.rigidbody.linearVelocity.x<.5&&e.rigidbody.linearVelocity.x>-.5&&(e.rigidbody.linearVelocity=new pc.Vec3(0,e.rigidbody.linearVelocity.y,e.rigidbody.linearVelocity.z)),e.rigidbody.linearVelocity.z<.5&&e.rigidbody.linearVelocity.z>-.5&&(e.rigidbody.linearVelocity=new pc.Vec3(e.rigidbody.linearVelocity.x,e.rigidbody.linearVelocity.y,0))),!arrow_right&!arrow_left&&(slowtorque=new pc.Vec3,slowtorque.set(0,-e.rigidbody.angularVelocity.y,0).normalize().scale(1),e.rigidbody.applyTorque(slowtorque),e.rigidbody.angularVelocity.y<.5&&e.rigidbody.angularVelocity.y>-.5&&(e.rigidbody.angularVelocity=new pc.Vec3(0,0,0)))}Charactercontroller.prototype.initialize=function(){this.entity.right.clone(),this.entity.forward.clone(),this.camera.forward,this.camera.right;this.eulers=new pc.Vec3;setInterval((function(){playerEnergy<100&&playerEnergy++}),250),setInterval((function(){playerHealth<100&&playerHealth>=1&&(playerHealth+=2)}),1e3)},Charactercontroller.prototype.update=function(e){playerHealth>0&&(Charactercontroller.prototype.handleMovement(this),Charactercontroller.prototype.handleWeapons(this),this.app.root.findByName("playerLaserBeamAssist").setRotation(this.app.root.findByName("Character").getRotation()));Charactercontroller.prototype.handleUI_Display(this),playerHealth<=0&&(this.entity.collision.type="box",this.entity.rigidbody.angularFactor=new pc.Vec3(1,1,1),deathSoundPlayed||(deathSoundPlayed=!0,this.entity.sound.play("Death"),this.entity.sound.stop("Music"),this.DeathObjects.enabled=!0),this.app.keyboard.wasPressed(pc.KEY_SPACE)&&SceneManager.prototype.ChangeScene(this.DEATHSCREEN))},Charactercontroller.prototype.handleMovement=function(e){W=e.app.keyboard.isPressed(pc.KEY_W),A=e.app.keyboard.isPressed(pc.KEY_A),S=e.app.keyboard.isPressed(pc.KEY_S),D=e.app.keyboard.isPressed(pc.KEY_D),arrow_right=e.app.keyboard.isPressed(pc.KEY_RIGHT),arrow_left=e.app.keyboard.isPressed(pc.KEY_LEFT),W&&(forwardForce=e.entity.right.clone().scale(2*moveMult)),S&&(forwardForce=e.entity.right.clone().scale(-2*moveMult)),!W&!S&&(forwardForce=e.entity.right.clone().scale(0)),D&&(rightForce=e.entity.forward.clone().scale(-2*moveMult)),A&&(rightForce=e.entity.forward.clone().scale(2*moveMult)),!A&!D&&(rightForce=e.entity.forward.clone().scale(0)),arrow_right&&e.entity.rigidbody.applyTorque(0,-3,0),arrow_left&&e.entity.rigidbody.applyTorque(0,3,0),e.entity.rigidbody.applyForce(forwardForce),e.entity.rigidbody.applyForce(rightForce),reduceSpeed(e.entity),e.entity.rigidbody.linearVelocity>0?e.entity.sound.play("Walk"):e.entity.sound.stop("Walk")},Charactercontroller.prototype.handleUI_Display=function(e){100==playerHealth?e.HealthText.element.text="Health: 100%":playerHealth>=10&&playerHealth<100?e.HealthText.element.text="Health: 0"+playerHealth.toString()+"%":playerHealth<9&&(e.HealthText.element.text="Health: 00"+playerHealth.toString()+"%"),100==playerEnergy?e.EnergyText.element.text="Energy: 100%":playerEnergy>=10&&playerEnergy<100?e.EnergyText.element.text="Energy: 0"+playerEnergy.toString()+"%":playerEnergy<9&&(e.EnergyText.element.text="Energy: 00"+playerEnergy.toString()+"%"),playerHealth>90&&playerHealth<=100?e.UIV2_Health.element.texture=e.HealthBars[5].resource:playerHealth>75&&playerHealth<89?e.UIV2_Health.element.texture=e.HealthBars[4].resource:playerHealth>50&&playerHealth<74?e.UIV2_Health.element.texture=e.HealthBars[3].resource:playerHealth>35&&playerHealth<49?e.UIV2_Health.element.texture=e.HealthBars[2].resource:playerHealth>10&&playerHealth<34?e.UIV2_Health.element.texture=e.HealthBars[1].resource:playerHealth>1&&playerHealth<9&&(e.UIV2_Health.element.texture=e.HealthBars[0].resource),playerEnergy>90&&playerEnergy<=100?e.UIV2_Energy.element.texture=e.EnergyBars[5].resource:playerEnergy>75&&playerEnergy<89?e.UIV2_Energy.element.texture=e.EnergyBars[4].resource:playerEnergy>50&&playerEnergy<74?e.UIV2_Energy.element.texture=e.EnergyBars[3].resource:playerEnergy>35&&playerEnergy<49?e.UIV2_Energy.element.texture=e.EnergyBars[2].resource:playerEnergy>10&&playerEnergy<34?e.UIV2_Energy.element.texture=e.EnergyBars[1].resource:playerEnergy>1&&playerEnergy<9&&(e.UIV2_Energy.element.texture=e.EnergyBars[0].resource),e.app.keyboard.isPressed(pc.KEY_F)&&e.app.keyboard.isPressed(pc.KEY_SHIFT)&&e.app.keyboard.isPressed(pc.KEY_ALT)&&(playerHealth-=1,playerEnergy-=1),e.app.keyboard.isPressed(pc.KEY_G)&&e.app.keyboard.isPressed(pc.KEY_SHIFT)&&e.app.keyboard.isPressed(pc.KEY_ALT)&&(playerHealth+=1,playerEnergy+=1),playerEnergy>100&&(playerEnergy=100),playerHealth>100&&(playerHealth=100),playerEnergy<0&&(playerEnergy=0),playerHealth<0&&(playerHealth=0),e.DamageOverlay.element.opacity=-(playerHealth-100)/100},Charactercontroller.prototype.handleWeapons=function(e){if(e.app.keyboard.wasReleased(pc.KEY_SHIFT)&&playerEnergy>=5){e.entity.sound.slot("Shoot").pitch=pc.math.random(.75,1.25),e.entity.sound.play("Shoot");var r=e.entity.findByName("playerLaserBeam").clone();e.entity.findByName("Aimassist").addChild(r),r.setLocalPosition(e.entity.findByName("playerLaserBeamAssist").getPosition()),r.setLocalRotation(e.entity.findByName("playerLaserBeamAssist").getRotation()),r.reparent(e.app.root),r.tags.add("projectile"),r.script.enabled=!0,r.enabled=!0,playerEnergy-=5}};var blue_DoorTrigger=pc.createScript("blue_doorTrigger"),b_active=!1,b_open=!1,b_intransit=!1,b_timing=!0,b_colliding=!1,b_collidedPlayerController=null;blue_DoorTrigger.attributes.add("blue_DoorToManage",{type:"entity"}),blue_DoorTrigger.attributes.add("blue_DoorOpenPoint",{type:"entity"}),blue_DoorTrigger.attributes.add("blue_DoorOrigin",{type:"entity"}),blue_DoorTrigger.attributes.add("blue_Player",{type:"entity"}),blue_DoorTrigger.prototype.initialize=function(){this.entity.collision.on("triggerenter",this.onblue_DoorTriggerEnter,this),this.entity.collision.on("triggerleave",this.onblue_DoorTriggerExit,this)},blue_DoorTrigger.prototype.update=function(){if(this.app.keyboard.on(pc.EVENT_KEYUP,this.onKeyUp,this),hasBlueKey){if(!b_open&&b_intransit&&this.blue_DoorToManage.translate(0,.01,0),!b_open&&b_intransit&&this.blue_DoorToManage.getPosition().y>=this.blue_DoorOpenPoint.getPosition().y&&(b_intransit=!1,b_open=!b_open,b_timing=!0),b_open&&b_intransit&&this.blue_DoorToManage.translate(0,-.01,0),b_open&&b_intransit&&this.blue_DoorToManage.getPosition().y<=this.blue_DoorOrigin.getPosition().y&&(b_intransit=!1,b_open=!b_open),b_timing&&b_open)setTimeout((function(){b_intransit=!0,b_timing=!1}),2e3);null!==b_collidedPlayerController&&(b_active&&!b_intransit?b_collidedPlayerController.messageBox.enabled=!0:b_active&&b_intransit?b_collidedPlayerController.messageBox.enabled=!1:b_active||(b_collidedPlayerController.messageBox.enabled=!1))}},blue_DoorTrigger.prototype.onblue_DoorTriggerEnter=function(e){if(e.tags.has("player")&&!b_intransit&&!b_open){if(hasBlueKey)this.blue_Player.script.get("charactercontroller").actionText.element.text="PRESS E TO OPEN THE DOOR";b_active=!0}},blue_DoorTrigger.prototype.onblue_DoorTriggerExit=function(e){b_active&&(b_active=!1,this.blue_Player.script.get("charactercontroller").actionText.element.text="")},blue_DoorTrigger.prototype.onKeyUp=function(e){if(b_active)if(hasBlueKey)b_active&&e.key==pc.KEY_E&&!b_intransit&&(b_intransit=!0,this.blue_Player.script.get("charactercontroller").actionText.element.text="OPENED THE BLUE DOOR WITH THE BLUE KEY",this.entity.sound.play("Door Open"),this.entity.sound.play("Door Allow"));else if(b_active&&e.key==pc.KEY_E&&!b_intransit){this.blue_Player.script.get("charactercontroller").actionText.element.text="A BLUE KEY IS REQUIRED TO OPEN THIS DOOR",this.entity.sound.play("Door Deny")}};var JunctionManager=pc.createScript("junctionManager"),BWD_SECTOR_ACTIVE=!0,FWD_SECTOR_ACTIVE=!1,BWD_COLLIDER_ACTIVE=!1,FWD_COLLIDER_ACTIVE=!1,LAST_COLLIDER_ACTIVE="not set";JunctionManager.attributes.add("FWD_COLLIDER",{type:"entity"}),JunctionManager.attributes.add("BWD_COLLIDER",{type:"entity"}),JunctionManager.attributes.add("FWD_SECTOR_A",{type:"entity"}),JunctionManager.attributes.add("BWD_SECTOR_A",{type:"entity"}),JunctionManager.attributes.add("FWD_SECTOR_B",{type:"entity"}),JunctionManager.attributes.add("BWD_SECTOR_B",{type:"entity"}),JunctionManager.attributes.add("FWD_SECTOR_C",{type:"entity"}),JunctionManager.attributes.add("BWD_SECTOR_C",{type:"entity"}),JunctionManager.prototype.initialize=function(){this.FWD_COLLIDER.collision.on("triggerenter",this.on_FWD_COLLIDER_Enter,this),this.FWD_COLLIDER.collision.on("triggerleave",this.on_FWD_COLLIDER_Exit,this),this.BWD_COLLIDER.collision.on("triggerenter",this.on_BWD_COLLIDER_Enter,this),this.BWD_COLLIDER.collision.on("triggerleave",this.on_BWD_COLLIDER_Exit,this)},JunctionManager.prototype.update=function(t){"not set"!=LAST_COLLIDER_ACTIVE&&("FWD"==LAST_COLLIDER_ACTIVE&&(FWD_SECTOR_ACTIVE=!0,BWD_SECTOR_ACTIVE=!1,this.FWD_SECTOR_A.enabled=!0,this.FWD_SECTOR_B.enabled=!0,this.FWD_SECTOR_C.enabled=!0,this.BWD_SECTOR_A.enabled=!1,this.BWD_SECTOR_B.enabled=!1,this.BWD_SECTOR_C.enabled=!1,console.log("[JunctionManager_001] Enabling "+this.FWD_SECTOR_A.name.toString()+", "+this.FWD_SECTOR_B.name.toString()+" and "+this.FWD_SECTOR_C.name.toString()),console.log("[JunctionManager_001] Disabling "+this.BWD_SECTOR_A.name.toString()+", "+this.BWD_SECTOR_B.name.toString()+" and "+this.BWD_SECTOR_C.name.toString()),LAST_COLLIDER_ACTIVE="not set"),"BWD"==LAST_COLLIDER_ACTIVE&&(FWD_SECTOR_ACTIVE=!1,BWD_SECTOR_ACTIVE=!0,this.FWD_SECTOR_A.enabled=!1,this.FWD_SECTOR_B.enabled=!1,this.FWD_SECTOR_C.enabled=!1,this.BWD_SECTOR_A.enabled=!0,this.BWD_SECTOR_B.enabled=!0,this.BWD_SECTOR_C.enabled=!0,console.log("[JunctionManager_001] Disabling "+this.FWD_SECTOR_A.name.toString()+", "+this.FWD_SECTOR_B.name.toString()+" and "+this.FWD_SECTOR_C.name.toString()),console.log("[JunctionManager_001] Enabling "+this.BWD_SECTOR_A.name.toString()+", "+this.BWD_SECTOR_B.name.toString()+" and "+this.BWD_SECTOR_C.name.toString()),LAST_COLLIDER_ACTIVE="not set"))},JunctionManager.prototype.on_FWD_COLLIDER_Enter=function(t){"Character"==t.name&&(FWD_COLLIDER_ACTIVE=!0,console.log("Entered FWD Collider"))},JunctionManager.prototype.on_FWD_COLLIDER_Exit=function(t){"Character"==t.name&&(FWD_COLLIDER_ACTIVE=!1,console.log("Left FWD Collider"),FWD_COLLIDER_ACTIVE||BWD_COLLIDER_ACTIVE||(LAST_COLLIDER_ACTIVE="FWD"))},JunctionManager.prototype.on_BWD_COLLIDER_Enter=function(t){"Character"==t.name&&(BWD_COLLIDER_ACTIVE=!0,console.log("Entered BWD Collider"))},JunctionManager.prototype.on_BWD_COLLIDER_Exit=function(t){"Character"==t.name&&(BWD_COLLIDER_ACTIVE=!1,console.log("Left BWD Collider"),FWD_COLLIDER_ACTIVE||BWD_COLLIDER_ACTIVE||(LAST_COLLIDER_ACTIVE="BWD"))};var JunctionManager_002=pc.createScript("JunctionManager_002"),_2_BWD_SECTOR_ACTIVE=!0,_2_FWD_SECTOR_ACTIVE=!1,_2_BWD_COLLIDER_ACTIVE=!1,_2_FWD_COLLIDER_ACTIVE=!1,_2_LAST_COLLIDER_ACTIVE="not set";JunctionManager_002.attributes.add("_2_FWD_COLLIDER",{type:"entity"}),JunctionManager_002.attributes.add("_2_BWD_COLLIDER",{type:"entity"}),JunctionManager_002.attributes.add("_2_FWD_SECTOR_A",{type:"entity"}),JunctionManager_002.attributes.add("_2_BWD_SECTOR_A",{type:"entity"}),JunctionManager_002.attributes.add("_2_FWD_SECTOR_B",{type:"entity"}),JunctionManager_002.attributes.add("_2_BWD_SECTOR_B",{type:"entity"}),JunctionManager_002.attributes.add("_2_FWD_SECTOR_C",{type:"entity"}),JunctionManager_002.attributes.add("_2_BWD_SECTOR_C",{type:"entity"}),JunctionManager_002.prototype.initialize=function(){this._2_FWD_COLLIDER.collision.on("triggerenter",this.on__2_FWD_COLLIDER_Enter,this),this._2_FWD_COLLIDER.collision.on("triggerleave",this.on__2_FWD_COLLIDER_Exit,this),this._2_BWD_COLLIDER.collision.on("triggerenter",this.on__2_BWD_COLLIDER_Enter,this),this._2_BWD_COLLIDER.collision.on("triggerleave",this.on__2_BWD_COLLIDER_Exit,this)},JunctionManager_002.prototype.update=function(_){"not set"!=_2_LAST_COLLIDER_ACTIVE&&("FWD"==_2_LAST_COLLIDER_ACTIVE&&(_2_FWD_SECTOR_ACTIVE=!0,_2_BWD_SECTOR_ACTIVE=!1,this._2_FWD_SECTOR_A.enabled=!0,this._2_FWD_SECTOR_B.enabled=!0,this._2_FWD_SECTOR_C.enabled=!0,this._2_BWD_SECTOR_A.enabled=!1,this._2_BWD_SECTOR_B.enabled=!1,this._2_BWD_SECTOR_C.enabled=!1,console.log("[JunctionManager_002] Enabling "+this._2_FWD_SECTOR_A.name.toString()+", "+this._2_FWD_SECTOR_B.name.toString()+" and "+this._2_FWD_SECTOR_C.name.toString()),console.log("[JunctionManager_002] Disabling "+this._2_BWD_SECTOR_A.name.toString()+", "+this._2_BWD_SECTOR_B.name.toString()+" and "+this._2_BWD_SECTOR_C.name.toString()),_2_LAST_COLLIDER_ACTIVE="not set"),"BWD"==_2_LAST_COLLIDER_ACTIVE&&(_2_FWD_SECTOR_ACTIVE=!1,_2_BWD_SECTOR_ACTIVE=!0,this._2_FWD_SECTOR_A.enabled=!1,this._2_FWD_SECTOR_B.enabled=!1,this._2_FWD_SECTOR_C.enabled=!1,this._2_BWD_SECTOR_A.enabled=!0,this._2_BWD_SECTOR_B.enabled=!0,this._2_BWD_SECTOR_C.enabled=!0,console.log("[JunctionManager_002] Disabling "+this._2_FWD_SECTOR_A.name.toString()+", "+this._2_FWD_SECTOR_B.name.toString()+" and "+this._2_FWD_SECTOR_C.name.toString()),console.log("[JunctionManager_002] Enabling "+this._2_BWD_SECTOR_A.name.toString()+", "+this._2_BWD_SECTOR_B.name.toString()+" and "+this._2_BWD_SECTOR_C.name.toString()),_2_LAST_COLLIDER_ACTIVE="not set"))},JunctionManager_002.prototype.on__2_FWD_COLLIDER_Enter=function(_){_2_FWD_COLLIDER_ACTIVE=!0,console.log("Entered FWD Collider")},JunctionManager_002.prototype.on__2_FWD_COLLIDER_Exit=function(_){_2_FWD_COLLIDER_ACTIVE=!1,console.log("Left FWD Collider"),_2_FWD_COLLIDER_ACTIVE||_2_BWD_COLLIDER_ACTIVE||(_2_LAST_COLLIDER_ACTIVE="FWD")},JunctionManager_002.prototype.on__2_BWD_COLLIDER_Enter=function(_){_2_BWD_COLLIDER_ACTIVE=!0,console.log("Entered BWD Collider")},JunctionManager_002.prototype.on__2_BWD_COLLIDER_Exit=function(_){_2_BWD_COLLIDER_ACTIVE=!1,console.log("Left BWD Collider"),_2_FWD_COLLIDER_ACTIVE||_2_BWD_COLLIDER_ACTIVE||(_2_LAST_COLLIDER_ACTIVE="BWD")};var JunctionManager_003=pc.createScript("JunctionManager_003"),_3_BWD_SECTOR_ACTIVE=!0,_3_FWD_SECTOR_ACTIVE=!1,_3_BWD_COLLIDER_ACTIVE=!1,_3_FWD_COLLIDER_ACTIVE=!1,_3_LAST_COLLIDER_ACTIVE="not set";JunctionManager_003.attributes.add("_3_FWD_COLLIDER",{type:"entity"}),JunctionManager_003.attributes.add("_3_BWD_COLLIDER",{type:"entity"}),JunctionManager_003.attributes.add("_3_FWD_SECTOR_A",{type:"entity"}),JunctionManager_003.attributes.add("_3_BWD_SECTOR_A",{type:"entity"}),JunctionManager_003.attributes.add("_3_FWD_SECTOR_B",{type:"entity"}),JunctionManager_003.attributes.add("_3_BWD_SECTOR_B",{type:"entity"}),JunctionManager_003.attributes.add("_3_FWD_SECTOR_C",{type:"entity"}),JunctionManager_003.attributes.add("_3_BWD_SECTOR_C",{type:"entity"}),JunctionManager_003.prototype.initialize=function(){this._3_FWD_COLLIDER.collision.on("triggerenter",this.on__3_FWD_COLLIDER_Enter,this),this._3_FWD_COLLIDER.collision.on("triggerleave",this.on__3_FWD_COLLIDER_Exit,this),this._3_BWD_COLLIDER.collision.on("triggerenter",this.on__3_BWD_COLLIDER_Enter,this),this._3_BWD_COLLIDER.collision.on("triggerleave",this.on__3_BWD_COLLIDER_Exit,this)},JunctionManager_003.prototype.update=function(_){"not set"!=_3_LAST_COLLIDER_ACTIVE&&("FWD"==_3_LAST_COLLIDER_ACTIVE&&(_3_FWD_SECTOR_ACTIVE=!0,_3_BWD_SECTOR_ACTIVE=!1,this._3_FWD_SECTOR_A.enabled=!0,this._3_FWD_SECTOR_B.enabled=!0,this._3_FWD_SECTOR_C.enabled=!0,this._3_BWD_SECTOR_A.enabled=!1,this._3_BWD_SECTOR_B.enabled=!1,this._3_BWD_SECTOR_C.enabled=!1,console.log("[JunctionManager_003] Enabling "+this._3_FWD_SECTOR_A.name.toString()+", "+this._3_FWD_SECTOR_B.name.toString()+" and "+this._3_FWD_SECTOR_C.name.toString()),console.log("[JunctionManager_003] Disabling "+this._3_BWD_SECTOR_A.name.toString()+", "+this._3_BWD_SECTOR_B.name.toString()+" and "+this._3_BWD_SECTOR_C.name.toString()),_3_LAST_COLLIDER_ACTIVE="not set"),"BWD"==_3_LAST_COLLIDER_ACTIVE&&(_3_FWD_SECTOR_ACTIVE=!1,_3_BWD_SECTOR_ACTIVE=!0,this._3_FWD_SECTOR_A.enabled=!1,this._3_FWD_SECTOR_B.enabled=!1,this._3_FWD_SECTOR_C.enabled=!1,this._3_BWD_SECTOR_A.enabled=!0,this._3_BWD_SECTOR_B.enabled=!0,this._3_BWD_SECTOR_C.enabled=!0,console.log("[JunctionManager_003] Disabling "+this._3_FWD_SECTOR_A.name.toString()+", "+this._3_FWD_SECTOR_B.name.toString()+" and "+this._3_FWD_SECTOR_C.name.toString()),console.log("[JunctionManager_003] Enabling "+this._3_BWD_SECTOR_A.name.toString()+", "+this._3_BWD_SECTOR_B.name.toString()+" and "+this._3_BWD_SECTOR_C.name.toString()),_3_LAST_COLLIDER_ACTIVE="not set"))},JunctionManager_003.prototype.on__3_FWD_COLLIDER_Enter=function(_){_3_FWD_COLLIDER_ACTIVE=!0,console.log("Entered FWD Collider")},JunctionManager_003.prototype.on__3_FWD_COLLIDER_Exit=function(_){_3_FWD_COLLIDER_ACTIVE=!1,console.log("Left FWD Collider"),_3_FWD_COLLIDER_ACTIVE||_3_BWD_COLLIDER_ACTIVE||(_3_LAST_COLLIDER_ACTIVE="FWD")},JunctionManager_003.prototype.on__3_BWD_COLLIDER_Enter=function(_){_3_BWD_COLLIDER_ACTIVE=!0,console.log("Entered BWD Collider")},JunctionManager_003.prototype.on__3_BWD_COLLIDER_Exit=function(_){_3_BWD_COLLIDER_ACTIVE=!1,console.log("Left BWD Collider"),_3_FWD_COLLIDER_ACTIVE||_3_BWD_COLLIDER_ACTIVE||(_3_LAST_COLLIDER_ACTIVE="BWD")};var BlueKeyPickup=pc.createScript("blueKeyPickup");BlueKeyPickup.attributes.add("blue_Player",{type:"entity"}),BlueKeyPickup.attributes.add("blue_UI",{type:"entity"}),BlueKeyPickup.prototype.initialize=function(){this.entity.collision.on("triggerenter",this.onKeyPickupTriggerEnter,this)},BlueKeyPickup.prototype.update=function(){this.entity.rotate(0,10,0)},BlueKeyPickup.prototype.onKeyPickupTriggerEnter=function(e){"Character"==e.name&&(hasBlueKey=!0,this.blue_Player.script.get("charactercontroller").actionText.element.text="PICKED UP BLUE KEY",this.blue_UI.enabled=!0,this.entity.sound.play("Pickup"),this.entity.destroy())};var timer,telephoneActive,TelephoneController=pc.createScript("telephoneController"),levelTime=0;TelephoneController.attributes.add("tele_Player",{type:"entity"}),TelephoneController.attributes.add("EndScreen_Time",{type:"entity"}),TelephoneController.attributes.add("ENDSCREEN",{type:"entity"}),TelephoneController.prototype.initialize=function(){this.entity.collision.on("triggerenter",this.onTelephoneRangeEnter,this),this.entity.collision.on("triggerleave",this.onTelephoneRangeExit,this),timer=setInterval((function(){levelTime++}),1e3)},TelephoneController.prototype.update=function(){this.app.keyboard.isPressed(pc.KEY_E)&&telephoneActive&&(console.log("LEVEL END"),clearTimeout(timer),this.EndScreen_Time.element.text=levelTime+"s",console.log(levelTime),SceneManager.prototype.ChangeScene(this.ENDSCREEN))},TelephoneController.prototype.onTelephoneRangeEnter=function(e){"Character"==e.name&&(this.tele_Player.script.get("charactercontroller").actionText.element.text="PRESS E TO PICK UP THE PHONE",telephoneActive=!0)},TelephoneController.prototype.onTelephoneRangeExit=function(e){"Character"==e.name&&(this.tele_Player.script.get("charactercontroller").actionText.element.text="",telephoneActive=!1)};var SceneManager=pc.createScript("sceneManager"),CurrentScene=null,lastLevelCompleted="not set",CurrentHelpIndex=0;SceneManager.attributes.add("MenuScenes",{type:"entity",array:!0}),SceneManager.attributes.add("LevelScenes",{type:"entity",array:!0}),SceneManager.attributes.add("HelpTextures",{type:"asset",assetType:"texture",array:!0}),SceneManager.attributes.add("HelpImage",{type:"entity"}),SceneManager.attributes.add("MenuMusicManager",{type:"entity"}),SceneManager.prototype.initialize=function(){SceneManager.prototype.ChangeScene(this.MenuScenes[0])},SceneManager.prototype.update=function(){SceneManager.prototype.handleTitleStart(this),SceneManager.prototype.handleButtons(this),SceneManager.prototype.handleHelpMenu(this),SceneManager.prototype.handleFullGameScreen(this),SceneManager.prototype.handleDeathScreen(this),"Level Complete"==CurrentScene.name&&SceneManager.prototype.handleEndgameScreen(this),this.MenuScenes.includes(CurrentScene)?this.MenuMusicManager.enabled=!0:this.MenuMusicManager.enabled=!1},SceneManager.prototype.handleTitleStart=function(e){CurrentScene==e.MenuScenes[0]&&e.app.keyboard.isPressed(pc.KEY_SPACE)&&SceneManager.prototype.ChangeScene(e.MenuScenes[1])},SceneManager.prototype.ChangeScene=function(e){null!==CurrentScene&&(CurrentScene.enabled=!1),console.log("DESTINATION: "+e.name),CurrentScene=e,console.log("CURRENTSCENE: "+CurrentScene.name),CurrentScene.enabled=!0},SceneManager.prototype.handleButtons=function(e){CurrentScene==e.MenuScenes[1]?e.app.keyboard.wasReleased(pc.KEY_1)?SceneManager.prototype.ChangeScene(e.MenuScenes[2]):e.app.keyboard.wasReleased(pc.KEY_2)&&SceneManager.prototype.ChangeScene(e.MenuScenes[3]):CurrentScene==e.MenuScenes[2]?e.app.keyboard.wasReleased(pc.KEY_1)?(SceneManager.prototype.ChangeScene(e.LevelScenes[0]),lastLevelCompleted="tutorial"):e.app.keyboard.wasReleased(pc.KEY_2)?(SceneManager.prototype.ChangeScene(e.LevelScenes[1]),lastLevelCompleted="E1M1"):e.app.keyboard.wasReleased(pc.KEY_0)&&SceneManager.prototype.ChangeScene(e.MenuScenes[1]):CurrentScene==e.MenuScenes[3]&&e.app.keyboard.wasReleased(pc.KEY_0)&&SceneManager.prototype.ChangeScene(e.MenuScenes[1])},SceneManager.prototype.handleHelpMenu=function(e){CurrentScene==e.MenuScenes[3]&&(e.app.keyboard.wasReleased(pc.KEY_5)?CurrentHelpIndex++:e.app.keyboard.wasReleased(pc.KEY_4)&&CurrentHelpIndex--,CurrentHelpIndex>e.HelpTextures.length-1&&(CurrentHelpIndex=0),CurrentHelpIndex<0&&(CurrentHelpIndex=e.HelpTextures.length-1),SceneManager.prototype.updateHelpScreen(e))},SceneManager.prototype.updateHelpScreen=function(e){e.HelpImage.element.texture=e.HelpTextures[CurrentHelpIndex].resource},SceneManager.prototype.handleEndgameScreen=function(e){e.app.keyboard.wasPressed(pc.KEY_SPACE)&&("tutorial"==lastLevelCompleted&&(console.log("handleEndgameScreen: returning to handleFullGameScreen:"),SceneManager.prototype.ChangeScene(e.MenuScenes[5])),"E1M2"==lastLevelCompleted&&(SceneManager.prototype.ChangeScene(e.MenuScenes[0]),lastLevelCompleted="E1M3"),"E1M1"==lastLevelCompleted&&(SceneManager.prototype.ChangeScene(e.LevelScenes[2]),lastLevelCompleted="E1M2"))},SceneManager.prototype.handleFullGameScreen=function(e){if(CurrentScene==e.MenuScenes[5]){setTimeout((function gametimout(){e.app.keyboard.wasPressed(pc.KEY_SPACE)&&(console.log("handleFullGameScreen: returning to main menu:"),SceneManager.prototype.ChangeScene(e.MenuScenes[0]))}),500)}},SceneManager.prototype.handleDeathScreen=function(e){"Death"==CurrentScene.name&&(console.log("Bye bye"),setTimeout((function(){e.app.keyboard.isPressed(pc.KEY_SPACE)&&window.location.reload()}),1e3))};var TutorialTextCycler=pc.createScript("tutorialTextCycler"),tutorialCardIndex=0;function waitAndRead(t){t.app.keyboard.isPressed(pc.KEY_SPACE)&&console.log("waiting minimum 1 second for the player to read this before skipping")}TutorialTextCycler.attributes.add("TutorialCards",{type:"entity",array:!0}),TutorialTextCycler.prototype.initialize=function(){},TutorialTextCycler.prototype.update=function(t){TutorialTextCycler.prototype.HandleInput(this),tutorialCardIndex>=this.TutorialCards.length&&(this.entity.enabled=!1)},TutorialTextCycler.prototype.HandleInput=function(t){t.app.keyboard.wasPressed(pc.KEY_SPACE)&&(tutorialCardIndex++,TutorialTextCycler.prototype.UpdateCard(t),setTimeout(waitAndRead(t),1e3))},TutorialTextCycler.prototype.UpdateCard=function(t){tutorialCardIndex-1<0||(t.TutorialCards[tutorialCardIndex-1].enabled=!1),tutorialCardIndex>=t.TutorialCards.length||(t.TutorialCards[tutorialCardIndex].enabled=!0)};var EnemyController=pc.createScript("enemyController");function distanceBetween(e,n){var t=e.getPosition(),o=n.getPosition(),a=o.x-t.x,i=o.y-t.y,r=o.z-t.z;return Math.sqrt(a*a+i*i+r*r)}EnemyController.attributes.add("EC_Player",{type:"entity"}),EnemyController.attributes.add("EnemiesToManage",{type:"entity",array:!0}),EnemyController.attributes.add("EnemiesInRange",{type:"boolean",array:!0}),EnemyController.attributes.add("EnemyHealth",{type:"number",array:!0}),EnemyController.attributes.add("EnemyDeathSoundPlayed",{type:"boolean",array:!0}),EnemyController.prototype.initialize=function(){for(var e=0;e<this.EnemiesToManage.length;e++)this.EnemiesToManage[e].collision.on("collisionstart",this.onContact,this)},EnemyController.prototype.update=function(){for(var e=0;e<this.EnemiesToManage.length;e++)distanceBetween(this.EnemiesToManage[e],this.EC_Player)<10?this.EnemiesInRange[e]=!0:this.EnemiesInRange[e]=!1,this.EnemyHealth[e]<=0&&!1===this.EnemyDeathSoundPlayed[e]&&(this.EnemiesToManage[e].collision.enabled=!1,this.EnemiesToManage[e].enabled=!1,this.entity.sound.play("Enemy 2"),this.EnemyDeathSoundPlayed[e]=!0);EnemyController.prototype.updateActiveEnemies(this),EnemyController.prototype.updateIdleEnemies(this)},EnemyController.prototype.updateActiveEnemies=function(e){for(var n=0;n<e.EnemiesInRange.length;n++)!0===e.EnemiesInRange[n]&&e.EnemyHealth[n]>0&&(e.EnemiesToManage[n].findByName("StingerChild").lookAt(e.EC_Player.getPosition()),e.EnemiesToManage[n].rigidbody.applyImpulse(e.EnemiesToManage[n].findByName("StingerChild").forward.scale(.1)),e.checkDamage(e))},EnemyController.prototype.updateIdleEnemies=function(e){for(var n=0;n<e.EnemiesToManage.length;n++)!1===e.EnemiesInRange[n]&&e.EnemyHealth[n]>0&&e.EnemiesToManage[n].findByName("StingerChild").rotateLocal(0,1,0)},EnemyController.prototype.reduceSpeed=function(e,n){slowforce=new pc.Vec3,slowforce.set(-n.rigidbody.linearVelocity.x,0,-n.rigidbody.linearVelocity.z).normalize().scale(5),n.rigidbody.applyForce(slowforce)},EnemyController.prototype.checkDamage=function(e){for(var n=0;n<e.EnemiesToManage.length;n++)distanceBetween(e.EnemiesToManage[n],e.EC_Player)<2&&e.EnemyHealth[n]>0&&playerHealth--},EnemyController.prototype.onContact=function(e){if(console.log(e.other.name),e.other.tags.has("projectile")){console.log("HAS TAG PROJECTILE");for(var n=0;n<this.EnemiesToManage.length;n++)console.log("Distance between"+e.other.name+":"+distanceBetween(e.other,this.EnemiesToManage[n])),distanceBetween(e.other,this.EnemiesToManage[n])<2&&(this.EnemyHealth[n]-=10,this.entity.sound.slot("Enemy 1").pitch=pc.math.random(.75,1.25),this.entity.sound.play("Enemy 1"))}};var Rotate=pc.createScript("rotate");Rotate.attributes.add("rX",{type:"number"}),Rotate.attributes.add("rY",{type:"number"}),Rotate.attributes.add("rZ",{type:"number"}),Rotate.prototype.update=function(t){this.entity.rotateLocal(this.rX,this.rY,this.rZ)};var BulletMove=pc.createScript("bulletMove");function distanceBetween(t,e){var i=t.getPosition(),n=e.getPosition(),o=n.x-i.x,a=n.y-i.y,s=n.z-i.z;return Math.sqrt(o*o+a*a+s*s)}BulletMove.prototype.initialize=function(){this.entity.collision.on("contact",this.onContact,this)},BulletMove.prototype.update=function(t){this.entity.rigidbody.applyImpulse(this.entity.right.scale(1)),distanceBetween(this.entity,this.app.root.findByName("Character"))>50&&this.entity.destroy()},BulletMove.prototype.onContact=function(t){this.entity.enabled=!1};var CameraMoveLoop=pc.createScript("cameraMoveLoop");CameraMoveLoop.prototype.update=function(t){this.entity.translate(0,0,-1),this.entity.getPosition().z<=-3300&&(console.log("Greater"),this.entity.setPosition(0,0,300))};var RedKeyPickup=pc.createScript("redKeyPickup");RedKeyPickup.attributes.add("Red_Player",{type:"entity"}),RedKeyPickup.attributes.add("Red_UI",{type:"entity"}),RedKeyPickup.prototype.initialize=function(){this.entity.collision.on("triggerenter",this.onKeyPickupTriggerEnter,this)},RedKeyPickup.prototype.update=function(){this.entity.rotate(0,10,0)},RedKeyPickup.prototype.onKeyPickupTriggerEnter=function(e){"Character"==e.name&&(hasRedKey=!0,this.Red_Player.script.get("charactercontroller").actionText.element.text="PICKED UP RED KEY",this.Red_UI.enabled=!0,this.entity.sound.play("Pickup"),this.entity.destroy())};var Red_DoorTrigger=pc.createScript("redDoorTrigger"),r_active=!1,r_open=!1,r_intransit=!1,r_timing=!0,r_colliding=!1,r_collidedPlayerController=null;Red_DoorTrigger.attributes.add("Red_DoorToManage",{type:"entity"}),Red_DoorTrigger.attributes.add("Red_DoorOpenPoint",{type:"entity"}),Red_DoorTrigger.attributes.add("Red_DoorOrigin",{type:"entity"}),Red_DoorTrigger.attributes.add("Red_Player",{type:"entity"}),Red_DoorTrigger.prototype.initialize=function(){this.entity.collision.on("triggerenter",this.onRed_DoorTriggerEnter,this),this.entity.collision.on("triggerleave",this.onRed_DoorTriggerExit,this)},Red_DoorTrigger.prototype.update=function(){if(this.app.keyboard.on(pc.EVENT_KEYUP,this.onKeyUp,this),hasRedKey){if(!r_open&&r_intransit&&this.Red_DoorToManage.translate(0,.01,0),!r_open&&r_intransit&&this.Red_DoorToManage.getPosition().y>=this.Red_DoorOpenPoint.getPosition().y&&(r_intransit=!1,r_open=!r_open,r_timing=!0),r_open&&r_intransit&&this.Red_DoorToManage.translate(0,-.01,0),r_open&&r_intransit&&this.Red_DoorToManage.getPosition().y<=this.Red_DoorOrigin.getPosition().y&&(r_intransit=!1,r_open=!r_open),r_timing&&r_open)setTimeout((function(){r_intransit=!0,r_timing=!1}),2e3);null!==r_collidedPlayerController&&(r_active&&!r_intransit?r_collidedPlayerController.messageBox.enabled=!0:r_active&&r_intransit?r_collidedPlayerController.messageBox.enabled=!1:r_active||(r_collidedPlayerController.messageBox.enabled=!1))}},Red_DoorTrigger.prototype.onRed_DoorTriggerEnter=function(e){if(e.tags.has("player")&&!r_intransit&&!r_open){if(hasRedKey)this.Red_Player.script.get("charactercontroller").actionText.element.text="PRESS E TO OPEN THE DOOR";r_active=!0}},Red_DoorTrigger.prototype.onRed_DoorTriggerExit=function(e){r_active&&(r_active=!1,this.Red_Player.script.get("charactercontroller").actionText.element.text="")},Red_DoorTrigger.prototype.onKeyUp=function(e){if(r_active)if(hasRedKey)r_active&&e.key==pc.KEY_E&&!r_intransit&&(r_intransit=!0,this.Red_Player.script.get("charactercontroller").actionText.element.text="OPENED THE Red DOOR WITH THE Red KEY",this.entity.sound.play("Door Open"),this.entity.sound.play("Door Allow"));else if(r_active&&e.key==pc.KEY_E&&!r_intransit){this.Red_Player.script.get("charactercontroller").actionText.element.text="A Red KEY IS REQUIRED TO OPEN THIS DOOR",this.entity.sound.play("Door Deny")}};var WarpJunction=pc.createScript("warpJunction");WarpJunction.attributes.add("Destination",{type:"entity"}),WarpJunction.attributes.add("WarpPlayer",{type:"entity"}),WarpJunction.prototype.initialize=function(){this.entity.collision.on("triggerenter",this.onContact,this)},WarpJunction.prototype.onContact=function(t,i){"Character"==t.name&&t.rigidbody.teleport(this.Destination.getPosition())};

//# sourceMappingURL=__game-scripts.js.map